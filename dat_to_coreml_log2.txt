scikit-learn version 1.6.1 is not supported. Minimum required version: 0.17. Maximum required version: 1.5.1. Disabling scikit-learn conversion API.
XGBoost version 2.1.4 has not been tested with coremltools. You may run into unexpected errors. XGBoost 1.4.2 is the most recent version that has been tested.
================================================================================
MTCNN C++ .dat → CoreML Direct Conversion
================================================================================

Phase 3: Building from source weights
Path: C++ binary .dat → PyTorch → CoreML


################################################################################
# Processing PNet
################################################################################

Loading C++ CNN from /Users/johnwilsoniv/repo/fea_tool/external_libs/openFace/OpenFace/matlab_version/face_detection/mtcnn/convert_to_cpp/PNet.dat...
Loading CNN from /Users/johnwilsoniv/repo/fea_tool/external_libs/openFace/OpenFace/matlab_version/face_detection/mtcnn/convert_to_cpp/PNet.dat
Network depth: 8 layers
DEBUG: Saved PNet layer 0 weight matrix (28x10) to /tmp/python_pnet_layer0_weight_matrix.bin
  Layer 0: Conv (3→10, 3x3)
  Layer 1: PReLU (10 channels)
  Layer 2: MaxPool (2x2, stride=2)
  Layer 3: Conv (10→16, 3x3)
  Layer 4: PReLU (16 channels)
  Layer 5: Conv (16→32, 3x3)
  Layer 6: PReLU (32 channels)
  Layer 7: FC (32→6)
Successfully loaded 8 layers!
✓ Loaded 8 layers

Building PyTorch PNet from C++ weights...
  Layer 0: ConvLayer
  Layer 1: PReLULayer
  Layer 2: MaxPoolLayer
  Layer 3: ConvLayer
  Layer 4: PReLULayer
  Layer 5: ConvLayer
  Layer 6: PReLULayer
  Layer 7: FullyConnectedLayer
✓ PyTorch PNet built with 9 layers

Validating PNet PyTorch vs C++ CNN...
Traceback (most recent call last):
  File "/Users/johnwilsoniv/Documents/SplitFace Open3/convert_dat_to_coreml.py", line 297, in <module>
    main()
  File "/Users/johnwilsoniv/Documents/SplitFace Open3/convert_dat_to_coreml.py", line 251, in main
    validation_passed = validate_pytorch_vs_cpp(pytorch_model, cpp_cnn, test_input, net_name)
  File "/Users/johnwilsoniv/Documents/SplitFace Open3/convert_dat_to_coreml.py", line 172, in validate_pytorch_vs_cpp
    pytorch_output = pytorch_model(test_input_torch)
  File "/Users/johnwilsoniv/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/johnwilsoniv/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/johnwilsoniv/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/Users/johnwilsoniv/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/johnwilsoniv/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/johnwilsoniv/Library/Python/3.10/lib/python/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (1x570400 and 32x6)
